# Schematic Development
*In every subcategory I will give a general breakdown of the design and then a component by component analysis so that the project is accessible to anyone. As always, please reach out if you notice any errors in this writeup*
## USB Data and Power
I decided on using USB2.0 without power delivery as this project does not require super high speed communication and requires a standard 5V (~1W) for its power. USB-C was used as it is slowly becoming the standard for new projects and I wanted to ensure future compatibility. Two voltage regulators are connected to VBUS to provide power for 3V3 logic and 1V9 power for the PMW3389.

![image](https://github.com/user-attachments/assets/c8a2ed55-8132-4a37-a7bf-a37e558c767d)

* J1 is a 16 pin USB-C receptacle. While not all 16 pins are necessary for this design, 16 pin models are very common and easy to source with the caveat that they are slightly harder to hand-solder. (Keep in mind that this project is being developed with reflow soldering in mind so the hand-solderability of components is not a main concern, this will become more obvious later on) 
* F1 is a resettable fuse with a hold current of 200mA and a trip current of 400mA (the key is that the trip current is less than the max 500mA available from USB2.0). As the naming scheme suggests, it is able to hold a constant current of 200mA and will trip if 400mA is exceeded, protecting both this peripheral and the host.
* R1 is a 5K1 resistor used to communicate that the device is a current sink, so that power is sent via VBUS. It should be within 10% tolerance (5% preferable).
* R2 is used for the same reason. Two resistors are required to comply with standards since USB-C can be inserted in either direction.
* C1 is a 10µF bulk capacitor that helps to decouple low frequency noise and smooth out voltage drops and power supply ripple.
* C2 is a smaller 0.1µF capacitor tasked with decoupling high frequency noise such as switching noise (like produced by the LDOs U1 and U2). When used later I will treat these two capacitors (C1, C2) together as their application stays mostly the same through the project.
* D1 is a TVS diode protecting VBUS from electrostatic discharge (ESD), if a high voltage is generated by ESD the diode becomes a low impedance path to ground, stopping the very high voltage entering the circuit.
* D2 are two TVS diodes protecting D+ and D- from ESD, they work on the same principle as D1, but are optimised for faster but lower energy ESD.

![image](https://github.com/user-attachments/assets/4f9106b1-09fa-45f4-83e3-14e9df3505ca)

* U1 is a low dropout regulator (LDO), it converts a higher voltage (5V) into a lower voltage (3.3V in this case). 3V3 is required for the PMW3389's logic. Usually the D+ line has to be pulled up to 3V3 to indicate full speed USB2.0 however the ATmega32u4 handles that itself.
* U2 is a similar LDO however it regulates the input 5V to 1V8. This is used to power the PMW3389. (Note: the datasheet of the PMW3389 reccomends 1V9 power however 1V8 LDOs are much more accessible which is why I am using them here)
* C3 is a 10µF bulk capacitor on the input of the LDO. It is used as described earlier, it should be placed as close to the LDO as possible.
* C4 is a 22 µF tantalum bulk capacitor that was recommended in the datasheet of the AMS1117. It's on the output of the LDo and serves a similar role to C3. It too should be placed as close to the LDO as possible.
* C5 fulfils the same role as C3 but for the second (1V9) LDO.
* C6 fulfils the same role as C5 but for the second (1V9) LDO.

## Optical Sensor and Supporting Components
I chose to base my design off of the PixArt PMW3389 as it is a relatively easily available high-performance optical sensor. It features a maximum polling rate of 1000Hz and maximum DPI of 16000.

![image](https://github.com/user-attachments/assets/ff7e762d-0594-49d1-8486-047991c55f5e)
![image](https://github.com/user-attachments/assets/f8acebdc-9af3-417c-b4de-8aa1bf388fd6)
![image](https://github.com/user-attachments/assets/b56c0888-a83f-4e94-8eb7-2d3fd21a4166)
## Microcontroller
![image](https://github.com/user-attachments/assets/1b3460f8-fcde-478e-a962-c09b69ebf93a)
![image](https://github.com/user-attachments/assets/c56c3b93-27c7-4209-bea0-471ebc21bee3)
![image](https://github.com/user-attachments/assets/d6531299-da45-445d-bb5d-a175cb22d1b8)
![image](https://github.com/user-attachments/assets/9a8cd165-6d67-4e35-a7c5-05b3aaef3601)
## MCU Inputs
![image](https://github.com/user-attachments/assets/48280276-853a-4410-a3f8-4ef5a7ac42a1)
![image](https://github.com/user-attachments/assets/a46cbc16-b0b8-4f13-bf23-9e5f5d7a764c)
## MCU Outputs
![image](https://github.com/user-attachments/assets/0d27df5c-b268-4ca9-88fe-d7c1f34a83b1)
## Programming
![image](https://github.com/user-attachments/assets/2ccc345d-aaaa-4010-8cb8-9fd28f34db43)




